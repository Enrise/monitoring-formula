<?xml version="1.0" ?>
<zabbix_export>
   <version>4.4</version>
   <date>2020-01-28T11:58:34Z</date>
   <groups>
      <group>
         <name>Templates</name>
      </group>
   </groups>
   <templates>
      <template>
         <template>Template App Redis</template>
         <name>Template App Redis</name>
         <groups>
            <group>
               <name>Templates</name>
            </group>
         </groups>
         <applications>
            <application>
               <name>Master Items</name>
            </application>
            <application>
               <name>Redis AOF</name>
            </application>
            <application>
               <name>Redis Client</name>
            </application>
            <application>
               <name>Redis CPU</name>
            </application>
            <application>
               <name>Redis Key</name>
            </application>
            <application>
               <name>Redis Memory</name>
            </application>
            <application>
               <name>Redis Network</name>
            </application>
            <application>
               <name>Redis RDB</name>
            </application>
            <application>
               <name>Redis Slave</name>
            </application>
            <application>
               <name>Redis Stats</name>
            </application>
         </applications>
         <discovery_rules>
            <discovery_rule>
               <name>Redis Discovery for Port</name>
               <type>ZABBIX_ACTIVE</type>
               <key>redis.port.discovery</key>
               <delay>30m</delay>
               <lifetime>1h</lifetime>
               <item_prototypes>
                  <item_prototype>
                     <name>Redis $1 Port Keyspace Hit ratio %</name>
                     <type>CALCULATED</type>
                     <key>keyspace_hit_percent[{#REDIS_PORT}]</key>
                     <delay>2m</delay>
                     <value_type>FLOAT</value_type>
                     <params>100*last(&quot;redis.info.json[{#REDIS_PORT},keyspace_hits]&quot;)/(last(&quot;redis.info.json[{#REDIS_PORT},keyspace_hits]&quot;)+last(&quot;redis.info.json[{#REDIS_PORT},keyspace_misses]&quot;))</params>
                     <applications>
                        <application>
                           <name>Redis Key</name>
                        </application>
                     </applications>
                  </item_prototype>
                  <item_prototype>
                     <name>Maxclients</name>
                     <type>DEPENDENT</type>
                     <key>redis.config.json[{#REDIS_PORT},maxclients]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_config.maxclients</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.config.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Maxmemory</name>
                     <type>DEPENDENT</type>
                     <key>redis.config.json[{#REDIS_PORT},maxmemory]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Memory</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_config.maxmemory</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.config.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>JSON Get config [ $1 ]</name>
                     <type>ZABBIX_ACTIVE</type>
                     <key>redis.config.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     <delay>5m</delay>
                     <history>0</history>
                     <trends>0</trends>
                     <value_type>TEXT</value_type>
                     <applications>
                        <application>
                           <name>Master Items</name>
                        </application>
                     </applications>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof current rewrite time</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_current_rewrite_time_sec]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_current_rewrite_time_sec</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof enabled</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_enabled]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <valuemap>
                        <name>Yes / No check</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_enabled</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof last bgrewrite</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_last_bgrewrite_status]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <valuemap>
                        <name>Yes / No check</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_last_bgrewrite_status</params>
                        </step>
                        <step>
                           <type>BOOL_TO_DECIMAL</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}=0</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} AOF last bgrewrite failed</name>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof last rewrite time</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_last_rewrite_time_sec]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_last_rewrite_time_sec</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof rewrite in progress</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_rewrite_in_progress]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <valuemap>
                        <name>Yes / No check</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_rewrite_in_progress</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{sum(#10)}=10</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} AOF rewrite in progress long time</name>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>Aof rewrite scheduled</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},aof_rewrite_scheduled]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis AOF</name>
                        </application>
                     </applications>
                     <valuemap>
                        <name>Yes / No check</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.aof_rewrite_scheduled</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}=1</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} AOF rewrite blocked by RDB SAVE</name>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>Blocked Clients</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},blocked_clients]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.blocked_clients</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Connected Clients</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},connected_clients]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.connected_clients</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Connected slaves</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},connected_slaves]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.connected_slaves</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Evicted keys rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},evicted_keys]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Key</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.evicted_keys</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Expired keys rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},expired_keys]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Key</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.expired_keys</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Keyspace hits rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},keyspace_hits]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Key</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.keyspace_hits</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Keyspace misses rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},keyspace_misses]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Key</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.keyspace_misses</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Latest fork time</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},latest_fork_usec]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <units>ms</units>
                     <applications>
                        <application>
                           <name>Redis Stats</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.latest_fork_usec</params>
                        </step>
                        <step>
                           <type>MULTIPLIER</type>
                           <params>0.001</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&gt;1000</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} latest fork time is too long</name>
                           <status>DISABLED</status>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>Memory fragmentation ratio</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},mem_fragmentation_ratio]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Memory</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.mem_fragmentation_ratio</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&gt;2</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} mem fragmentation ratio Too high</name>
                           <status>DISABLED</status>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>rdb bgsave in progress</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},rdb_bgsave_in_progress]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis RDB</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.rdb_bgsave_in_progress</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>rdb changes since last save</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},rdb_changes_since_last_save]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis RDB</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.rdb_changes_since_last_save</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>rdb current bgsave time sec</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},rdb_current_bgsave_time_sec]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis RDB</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.rdb_current_bgsave_time_sec</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>rdb last bgsave status</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},rdb_last_bgsave_status]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis RDB</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.rdb_last_bgsave_status</params>
                        </step>
                        <step>
                           <type>BOOL_TO_DECIMAL</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}=0</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} rdb last bgsave failed</name>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                                 <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>rdb last bgsave time sec</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},rdb_last_bgsave_time_sec]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis RDB</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.rdb_last_bgsave_time_sec</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Request Rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},total_commands_processed]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.total_commands_processed</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Connection Rate</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},total_connections_received]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis Client</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.total_connections_received</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Total net input bytes</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},total_net_input_bytes]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <units>bytes</units>
                     <applications>
                        <application>
                           <name>Redis Network</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.total_net_input_bytes</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Total net output bytes</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},total_net_output_bytes]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <units>bytes</units>
                     <applications>
                        <application>
                           <name>Redis Network</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.total_net_output_bytes</params>
                        </step>
                        <step>
                           <type>CHANGE_PER_SECOND</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used cpu sys</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_cpu_sys]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis CPU</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_cpu_sys</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used cpu sys children</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_cpu_sys_children]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis CPU</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_cpu_sys_children</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used cpu user</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_cpu_user]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis CPU</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_cpu_user</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used cpu user children</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_cpu_user_children]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <applications>
                        <application>
                           <name>Redis CPU</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_cpu_user_children</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used memory</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_memory]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <units>bytes</units>
                     <applications>
                        <application>
                           <name>Redis Memory</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_memory</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Used memory rss</name>
                     <type>DEPENDENT</type>
                     <key>redis.info.json[{#REDIS_PORT},used_memory_rss]</key>
                     <delay>0</delay>
                     <value_type>FLOAT</value_type>
                     <units>bytes</units>
                     <applications>
                        <application>
                           <name>Redis Memory</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_info.used_memory_rss</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>JSON Get info [ $1 ]</name>
                     <type>ZABBIX_ACTIVE</type>
                     <key>redis.info.json[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     <delay>2m</delay>
                     <history>0</history>
                     <trends>0</trends>
                     <value_type>TEXT</value_type>
                     <applications>
                        <application>
                           <name>Master Items</name>
                        </application>
                     </applications>
                  </item_prototype>
                  <item_prototype>
                     <name>Redis $1 PING</name>
                     <type>ZABBIX_ACTIVE</type>
                     <key>redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                     <units>PONG</units>
                     <applications>
                        <application>
                           <name>Redis Stats</name>
                        </application>
                     </applications>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{sum(#3)}=0</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                           <priority>DISASTER</priority>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
               </item_prototypes>
               <trigger_prototypes>
                  <trigger_prototype>
                     <expression>{Template App Redis:redis.info.json[{#REDIS_PORT},connected_clients].last(0)}/{Template App Redis:redis.config.json[{#REDIS_PORT},maxclients].last(0)}&gt;0.8</expression>
                     <name>{HOST.NAME} Redis {#REDIS_PORT} maxclients &gt;= 80%</name>
                     <priority>WARNING</priority>
                     <dependencies>
                        <dependency>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                           <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                        </dependency>
                     </dependencies>
                  </trigger_prototype>
                  <trigger_prototype>
                     <expression>{Template App Redis:redis.info.json[{#REDIS_PORT},used_memory].last(0)}/{Template App Redis:redis.config.json[{#REDIS_PORT},maxmemory].last(0)}&gt;0.95</expression>
                     <name>{HOST.NAME} Redis {#REDIS_PORT} maxmemory &gt;= 95%</name>
                     <status>DISABLED</status>
                     <priority>WARNING</priority>
                     <dependencies>
                        <dependency>
                           <name>{HOST.NAME} Redis {#REDIS_PORT} PING failed</name>
                           <expression>{Template App Redis:redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}].sum(#3)}=0</expression>
                        </dependency>
                     </dependencies>
                  </trigger_prototype>
               </trigger_prototypes>
               <graph_prototypes>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Aof rewrite status</name>
                     <graph_items>
                        <graph_item>
                           <color>1A7C11</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_current_rewrite_time_sec]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_enabled]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>2774A4</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_last_bgrewrite_status]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>A54F10</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_last_rewrite_time_sec]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>4</sortorder>
                           <color>FC6EA3</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_rewrite_in_progress]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>5</sortorder>
                           <color>6C59DC</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},aof_rewrite_scheduled]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Connection</name>
                     <graph_items>
                        <graph_item>
                           <color>0000DD</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},blocked_clients]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>00CC00</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},connected_clients]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>2774A4</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},total_connections_received]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>A54F10</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},total_commands_processed]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>4</sortorder>
                           <color>222222</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},connected_slaves]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>5</sortorder>
                           <color>EE0000</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.config.json[{#REDIS_PORT},maxclients]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port CPU</name>
                     <graph_items>
                        <graph_item>
                           <color>0000DD</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_cpu_sys]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>00CC00</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_cpu_sys_children]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>DD0000</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_cpu_user]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>EE00EE</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_cpu_user_children]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Expired Evicted keys</name>
                     <graph_items>
                        <graph_item>
                           <color>EE0000</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},evicted_keys]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>666600</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},expired_keys]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Keyspace Hit</name>
                     <graph_items>
                        <graph_item>
                           <color>00CC00</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},keyspace_hits]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},keyspace_misses]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>DD00DD</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>keyspace_hit_percent[{#REDIS_PORT}]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Net traffic</name>
                     <graph_items>
                        <graph_item>
                           <drawtype>GRADIENT_LINE</drawtype>
                           <color>00BB00</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},total_net_input_bytes]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <drawtype>GRADIENT_LINE</drawtype>
                           <color>0000EE</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},total_net_output_bytes]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port PING and latest fork</name>
                     <graph_items>
                        <graph_item>
                           <color>1A7C11</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},latest_fork_usec]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.port.ping[{#REDIS_PORT}, {$REDIS_AUTH}]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port rdb</name>
                     <graph_items>
                        <graph_item>
                           <color>1A7C11</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},rdb_bgsave_in_progress]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},rdb_changes_since_last_save]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>2774A4</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},rdb_current_bgsave_time_sec]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>A54F10</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},rdb_last_bgsave_status]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>4</sortorder>
                           <color>EE00EE</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},rdb_last_bgsave_time_sec]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT} Port Used Memory</name>
                     <graph_items>
                        <graph_item>
                           <drawtype>DASHED_LINE</drawtype>
                           <color>DD0000</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.config.json[{#REDIS_PORT},maxmemory]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>00CC00</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_memory]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>3333FF</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},used_memory_rss]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>DD00DD</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.info.json[{#REDIS_PORT},mem_fragmentation_ratio]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
               </graph_prototypes>
            </discovery_rule>
            <discovery_rule>
               <name>Redis Discovery for slave Port</name>
               <type>ZABBIX_ACTIVE</type>
               <key>redis.repl.discovery</key>
               <delay>30m</delay>
               <status>DISABLED</status>
               <lifetime>1h</lifetime>
               <item_prototypes>
                  <item_prototype>
                     <name>Master last io seconds ago</name>
                     <type>DEPENDENT</type>
                     <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_last_io_seconds_ago]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis Slave</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_slaveinfo.master_last_io_seconds_ago</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Master link status (1:up,0:down)</name>
                     <type>DEPENDENT</type>
                     <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_link_status]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis Slave</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_slaveinfo.master_link_status</params>
                        </step>
                        <step>
                           <type>BOOL_TO_DECIMAL</type>
                           <params/>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE}, {$REDIS_AUTH}]</key>
                     </master_item>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&lt;&gt;1</expression>
                           <name>{HOST.NAME} Redis {#REDIS_PORT_SLAVE} master link down</name>
                           <priority>HIGH</priority>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>Master sync in progress</name>
                     <type>DEPENDENT</type>
                     <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_sync_in_progress]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis Slave</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_slaveinfo.master_sync_in_progress</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>Slave read only</name>
                     <type>DEPENDENT</type>
                     <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},slave_read_only]</key>
                     <delay>0</delay>
                     <applications>
                        <application>
                           <name>Redis Slave</name>
                        </application>
                     </applications>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.redis_slaveinfo.slave_read_only</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE}, {$REDIS_AUTH}]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>JSON Get slave info [ $1 ]</name>
                     <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE}, {$REDIS_AUTH}]</key>
                     <delay>30s</delay>
                     <history>1h</history>
                     <trends>0</trends>
                     <value_type>TEXT</value_type>
                     <applications>
                        <application>
                           <name>Redis Slave</name>
                        </application>
                     </applications>
                  </item_prototype>
               </item_prototypes>
               <graph_prototypes>
                  <graph_prototype>
                     <name>Redis {#REDIS_PORT_SLAVE} Port Slave status</name>
                     <graph_items>
                        <graph_item>
                           <color>1A7C11</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_last_io_seconds_ago]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_link_status]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>2774A4</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},master_sync_in_progress]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>A54F10</color>
                           <item>
                              <host>Template App Redis</host>
                              <key>redis.slaveinfo.json[{#REDIS_PORT_SLAVE},slave_read_only]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
               </graph_prototypes>
            </discovery_rule>
         </discovery_rules>
         <macros>
            <macro>
               <macro>{$REDIS_AUTH}</macro>
            </macro>
         </macros>
      </template>
   </templates>
   <value_maps>
      <value_map>
         <name>Yes / No check</name>
         <mappings>
            <mapping>
               <value>0</value>
               <newvalue>No</newvalue>
            </mapping>
            <mapping>
               <value>1</value>
               <newvalue>Yes</newvalue>
            </mapping>
         </mappings>
      </value_map>
   </value_maps>
</zabbix_export>
